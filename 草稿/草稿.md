$$
R=\begin{bmatrix}
q_{0}^{2}+q_{1}^{2}-q_{2}^{2}-q_{3}^{2} & 2(q_{1}q_{2}-q_{0}q_{3})  & 2(q_{0}q_{2}+q_{1}q_{3}) \\
2(q_{1}q_{2}+q_{0}q_{3})  & q_{0}^{2}-q_{1}^{2}+q_{2}^{2}-q_{3}^{2}  & 2(q_{2}q_{3}-q_{0}q_{1}) \\
2(q_{1}q_{3}-q_{0}q_{2})  & 2(q_{0}q_{1}+q_{2}q_{3})  & q_{0}^{2}-q_{1}^{2}-q_{2}^{2}+q_{3}^{2}
\end{bmatrix}
$$
$$
\begin{cases}
\varphi=\arctan2(R(3,2),R(3,3)) \\
\theta=-\arcsin(R(3,1)) \\
\psi=\arctan2(R(2,1),R(1,1))
\end{cases}
$$